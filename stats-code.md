
We will write an R script that does the following:
- Reads data from a file named "data.xlsx" in the "input" folder of the current working directory, which is an excel table with a clinical trial data with each subject's data on a line and variables as columns.
- The data will be in tidy format, which has each variable as a column and each observation as a row, with duplications as necessary. From now on all data should be in the tidy format, unless otherwise specified.
- Calculates the mean, median, standard deviation and interquartile range for each of a certain list of variables that the user can input in a file named "target-variables-stats.csv". These statistic should be calculated for the entire sample and for each group individually. The output should be in table format with the statistics for each variable, one variable per line and the statistics as columns, saved in a file named "descriptive-stats.csv" on a folder named "output" in the current working directory.
- Calculates the absolute and relative frequency for each of a certain list of variables that the user can input in a file named "target-variables-freq.csv". These statistic should be calculated for the entire sample and for each group individually. The output should be in table format with the statistics for each variable, one variable per line and the statistics as columns, saved in a file named "var-freq.csv" on a folder named "output" in the current working directory.
- Calculates the difference between groups for each of a certain list of variables that the user can input in a file named "target-variables-group-diff.csv". These differences should include significance tests and confidence intervals. The output should be in table format with the statistics for each variable, one variable per line and the statistics as columns, saved in a file named "group-diff.csv" on a folder named "output" in the current working directory. The output should inform the statistical test and significance level used, as well as any other important information for the calculations.
- Calculates the correlation between each pair of variables in a certain list of variables that the user can input in a file named "target-variables-cor.csv". The output should be a correlation matrix and inform the correlation coefficient and significance level for each correlation. The output should be saved in a file named "descriptive-cor.csv" on a folder named "output" in the current working directory.
- Based on the variable "Idade" (the age of subjects) create a cathegorical variable for those under or equalto 20 years of age and those over 20 years of age. Save the data including this new variable in a file named "data-with-age-cat.csv" on the "input" folder. Use this data to calculate the difference between subjects under 20 years of age and those above 20 years of age for the entire sample for each of a certain list of variables that the user can input in a file named "target-variables-age-diff.csv". These differences should include significance tests and confidence intervals. The output should be in table format with the statistics for each variable, one variable per line and the statistics as columns, saved in a file named "group-diff-age-cat.csv" on a folder named "output" in the current working directory. The output should inform the statistical test and significance level used, as well as any other important information for the calculations.
We won't work on charts or data visualization for this project.
The data contain the following variables, most of them with numeric values, one with date and NA representing missing values, in the specific order below. These are the first three line of the dataset:
ID,Grupo,Idade,Sexo,Mutacao,Pseudomonas_cronico,Dias_ATB,Internacao,Dias_internacao,Altura_cm,Peso_kg,IMC_absoluto,IMC_escorez,DNA_1,DNA_2,DNA_corrigido15x,DNAcat243,VEF1absoluto,VEF1percprevist,VEF1_menor80,VEF1_menor60,CVFabsoluto,CVFpercprevist,VEF1CVFabsoluto,FEF2575absoluto,FEF2575percprevist,Data_TECP,FCinicial,FCLimiarAnaeróbico,FCfinal,FCmudanca,FCmaxatingida,FCmax,ReservaCardíaca,PASistInicial,PADiastInicial,PASistFinal,PADiastFinal,SpO2inicial,SpO2LimiarAnaeróbico,SpO2final,SPO2cat,SpO2mudanca,SpO2dessaturou,VO2maxpicoouplato,VO2Lminabsolutoinicial,VO2Lminabsolutofinal,VO2mLkgmininicial,VO2mLkgminfinal,VO2categ,Veabsolutoinicial,VEabsolutofinal,VEVO2repouso,VEVO2final,VEVCO2repouso,VEVCO2final,VVM,ReservaVentilatória,PulsodeO2,RQrepouso,RQfinal,VO2LALmin,VO2LAmLKgMin,VOLA,VELminLA,VEVO2LA,VEVCO2LA
1,1,11.41,1,1,2,42,2,0,154.0,65.5,27.6,2.84,4.79,7.42,91.6,1,2.36,91.5,2,2,2.78,91.5,0.85,2.50,86.5,15-Aug-2018,93.0,171.0,200.0,107.0,200.0,100.0,0.01,110,60,140,60,98,98,98,2,0,2,1,0.63,2.28,9.80,35.50,2,13.20,64.80,21.00,28.40,24.40,25.60,87.8,26.2,11.4,0.86,1.11,1.63,25.3,71.3,36.4,22.3,22.3
2,1,9.67,1,3,2,56,1,14,129.0,28.3,17.0,0.39,5.51,NA,82.7,1,0.58,34.7,1,1,1.02,53.1,0.57,0.28,13.9,10/11/2017,139.0,161.0,182.0,43.0,182.0,90.2,9.81,100,60,120,70,98,94,97,2,-1,2,1,0.27,0.84,10.50,32.60,2,8.10,28.50,30.00,33.90,38.60,31.30,31.1,8.4,8.5,0.78,1.08,0.66,25.6,78.5,20.3,30.8,29.4

For now, explain each step this script should have, considering good pratices and explain how you should write this script. Don't output the script yet.